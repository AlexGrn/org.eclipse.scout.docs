
ifndef::finaldoc[]
include::_initDoc.adoc[]
endif::finaldoc[]

//fallback for safe mode == secure:
ifndef::imgsdir[:imgsdir: ../../../../imgs]
ifndef::codedir[:codedir: ../../../../../code]
ifndef::mdledir[:mdledir: ../../../../adoc]
:experimental:

//-----------------------------------------------------------------------------
//Asciidoctor input file: "One Day Tutorial"
//
//WARNING: this file is a text module, it should be embedded in a master asciidoctor document.
//-----------------------------------------------------------------------------

[[cha-large_example]]
== A One Day Tutorial

In this chapter we will create the "`Contacts`" Scout application. 
The goal of this tutorial application is to learn about the most prominent features of the Eclipse Scout framework using a fully functioning application. 

The application is kept small enough to complete this tutorial within less than a day.
An extended version of "`Contacts`" is available as a Scout sample application on https://github.com/BSI-Business-Systems-Integration-AG/org.eclipse.scout.docs/tree/releases/6.0.x/code/contacts[Github].

As a prerequisite to this tutorial we assume that the reader has successfully completed the chapters "Hello World Tutorial" and "Import the Scout Demo Applications" as described in the Eclipse Scout user guide.
To access the Scout user guide help hit kbd:[F1] in the Eclipse IDE.
This opens the Eclipse help view that includes the Eclipse Scout User Guide as shown in <<img-sdk_f1>>.

[[img-sdk_f1, Figure 000]]
.The Eclipse help view including the Eclipse Scout User Guide.
image::{imgsdir}/sdk_f1.png[]

The "`Contacts`" tutorial is organized as follows.
In the first section, the finished "`Contacts`" application is explained from the user perspective.
The remaining sections focus on the individual steps to implement the "`Contacts`" tutorial application.

//--- tutorial intro --------------------------------------------------------//

include::_TutorialIntro.adoc[]

//--- tutorial steps --------------------------------------------------------//

[[sec-contacts_initial_project]]
=== Setting up the Initial Project
include::_TutorialStep1.adoc[]

[[sec-contacts_pages]]
=== Adding the Person and Organization Page
include::_TutorialStep2.adoc[]

[[sec-contacts_jdbc]]
=== Creating and Accessing the Database
include::_TutorialStep3.adoc[]

[[sec-contacts_forms]]
=== Adding Forms to Create/Edit Persons and Organizations
include::_TutorialStep4.adoc[]

[[sec-contacts_link_organization_person]]
=== Linking Oranizations and Persons
include::_TutorialStep5.adoc[]

[[sec-contacts_outlook]]
=== Next Steps and Outlook
include::_TutorialStep6.adoc[]



== OLD STUFF


=== Creating the Person Form

[[img-new_form_person, Figure 000]]
image::{imgsdir}/new_form_person_contextmenu.png[]
.Add the person form.
image::{imgsdir}/new_form_person.png[]

In this section we will create the person form that is used to display and edit the persons stored in the "`My Contacts`" application.
To add the person form use the Scout SDK [wizard]_New Form_ wizard as shown in <<img-new_form_person>>.
In the first wizard step you just need to enter "`Person`" as a new translated text into the [field]_Name_ field and add "`ui.forms`" as the sub-package name in the corresponding wizard field.
Then click the btn:[Finish] button.

The wizard will create the necessary artefacts in the application's client, the shared and the server plugin projects.
On the client side the [java]+PersonForm+ class with the necessary form handlers is created, in the shared part, the [java]+PersonFormData+ transfer object is added.
On the server side, a [java]+PersonProcessService+ with all necessary service operations referenced by the form handlers is implemented.

[[img-new_bean_personid, Figure 000]]
image::{imgsdir}/new_bean_personid_contextmenu.png[]
.Add the [element]_PersonId_ variable to the person form.
image::{imgsdir}/new_bean_personid.png[]

To hold the persons primary key in the person form we also need to add a corresponding variable.
For this, use the [wizard]_New Property Bean_ wizard as shown in <<img-new_bean_personid>>.
In the wizard dialog, enter "`PersonId`" into the [field]_Name_ field and pick [java]+String+ from the dropdown list provided in the [field]_Bean type_ field.
Then, click the btn:[Finish] button to close the wizard.


==== Creating the Form Layout with From Fields

[[img-new_field_personbox, Figure 000]]
image::{imgsdir}/new_field_personbox.png[]
.Add the first group box field to the person form.
image::{imgsdir}/new_field_personbox_name.png[]

As a next step we create the main layout structure of the person form.
According to the screenshot of the person form shown in <<img-my_contacts_swt>> the form is organized into an upper box including the first name, the last name and a picture field.
In the "`Details`" box in the lower half of the form some additional fields are found, such as the date of birth field.
And the bottom of the form holds a "`Show Map ...`" link.
We start with the general layout by adding the [java]+PersonBox+ according to <<img-new_field_personbox>>.
In the first step (omitted in <<img-new_field_personbox>>) of the new form field wizard the field type [java]+GroupBox+ has to be selected.
Below the person box we add the detail group box.
As before, we select the  [java]+GroupBox+ field type and click on the btn:[Next] button.
In the second wizard step we then enter the text "`Detail`" into the [field]_Name_ field.

We now add the form fields listed below using the the [wizard]_New Form Field_ wizard multiple times.
Most fields are of type [java]+StringField+ and different field types are separately indicated.

 * `PersonBox`
 ** "`First Name`"
 ** "`Last Name`"
 ** "`Picture URL`"
 ** PictureField (`ImageField`)
 * "`Detail`" DetailBox
 ** "`Headline`"
 ** "`Location`"
 ** "`Date of Birth`" (`DateField`)


[[img-new_field_picture, Figure 000]]
image::{imgsdir}/new_field_picture_contextmenu.png[]
.Add the picture field to the first group box of the person form.
image::{imgsdir}/new_field_picture.png[]

As an example for adding the form fields, the process is illustrated in <<img-new_field_picture>> for the creation of the picture field.
In the field list we need to set non default properties for the [field]_PictureUrlField_ field and the [field]_PictureField_ field.
The picture URL field will hold an URL pointing to the picture of the person to be displayed.
As in the person form only the picture is to be displayed but not the picture URL, we need to make this field invisible.
For this, select the [node]_PictureUrlField_ node in the Scout Explorer and then untick the [field]_Visible_ field in the Scout Object Properties.
Note that to access the visibility property you need to open the section [element]_Advanced Properties_ first.

[[img-picture_field_properties, Figure 000]]
image::{imgsdir}/picture_field_properties_1.png[]
.Set the properties for the picture field of the person form.
image::{imgsdir}/picture_field_properties_2.png[]

As the configuration of the picture field is more complex than the other fields, the changed properties are shown in the screenshots provided in <<img-picture_field_properties>>.
First, no label is shown for the picture field as shown in the unticked [field]_Label Visible_ field of the Scout Object Properties.
Then, property [element]_Grid H_ is set to 5.
This results in the picture to cover the vertical space of 5 form fields.

(((getConfiguredMasterField, execChangedMasterValue, IOUtility)))
[[lst-mycontacts.client.forms.person.picturefield, Listing execChangedMasterValue PictureField]]
[source,java]
.The behaviour of the person form's [java]+PictureField+ is triggered by changes in field [java]+PictureUrlField+.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.client/src/org/eclipsescout/contacts/client/ui/forms/PersonForm.java[lines=233..235;251..267;286..287]
----


Finally, we want the picture to be refreshed whenever the content of the picture URL is changed.
For this, the property [element]_Master Field_ is set to the [java]+PictureUrlField+.
The implementation of the corresponding method [java]+execChangedMasterValue+ is provided in <<lst-mycontacts.client.forms.person.picturefield>>.
As we can see, the Scout helper class [java]+IOUtility+ is used to read the image content from the provided URL.
This content is then used to assign the image content with the image field's method [java]+setImage+.
Method [java]+setAutoFit+ is called to adapt the picture to the dimensions available to the image field.


==== A simple Form to edit the Picture URL

[[img-new_form_url, Figure 000]]
image::{imgsdir}/new_form_url_1.png[]
.Add the URL editor form. This form does not need any connections to the server. Therefore, the related components such as services and the form data can be removed in the second wizard step shown on the right side.
image::{imgsdir}/new_form_url_2.png[]

To edit a person's picture link, we create a simple URL editor form as shown in <<img-new_form_url>>.
As we only need this form to update the URL information of a person's picture field, we do not need any connectivity to the backend of the "`My Contacts`" application.
That is why almost all form and service artefacts are deselected in the second wizard step shown on the right side of <<img-new_form_url>>.

[[lst-mycontacts.client.forms.pictureurl, Listing PictureURLField]]
[source,java]
.The UI structure of the [java]+PictureURLForm+ used to update the URL of the picture field in the person form.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.client/src/org/eclipsescout/contacts/client/ui/forms/PictureURLForm.java[lines=24..25;99..113;122..122;126..127]
----


As this form only holds a single URL field, we omit the description of the creation of the URL editor form's content and provide the resulting Java code instead.
In <<lst-mycontacts.client.forms.pictureurl>> just the form's [java]+MainBox+ code is shown.

[[img-new_menu_editurl, Figure 000]]
image::{imgsdir}/new_menu_editurl_contextmenu.png[]
.Add the URL edit menu to the picture field.
image::{imgsdir}/new_menu_editurl.png[]

This form is then started via an "`Edit URL ...`" contextmenu on the image field.
The creation of this contextmenu is shown in <<img-new_menu_editurl>>.
See <<lst-mycontacts.client.forms.person.picturefield.editmenu>> for the actual implementation of the [java]+execAction+ for this contextmenu.

(((execAction)))
[[lst-mycontacts.client.forms.person.picturefield.editmenu, Listing EditURLMenu]]
[source,java]
.The edit menu implemented in class [java]+EditURLMenu+ of the picture field. If the URL was changed the picture URL field of the person form is set accordingly in method [java]+execAction+
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.client/src/org/eclipsescout/contacts/client/ui/forms/PersonForm.java[lines=268..285]
----


Once the edit URL form is started with [java]+form.startModify()+ the client waits in method [java]+form.waitFor+ until the form is closed by the user.
If the user has changed any field content (the picture URL in our case) and closed the form with the btn:[OK] button, the method [java]+form.isFormStored+ returns true, and we can copy the new URL from the editor form field into the picture URL field of the person form.
Such a change will then trigger method [java]+execChangedMasterValue+ of the [java]+PictureField+ which in turn updates the image shown in the person form.


==== Linking the Person Form to the Person Page

[[img-new_menu_editperson, Figure 000]]
image::{imgsdir}/new_menu_editperson_contextmenu.png[]
.Add the Person edit menu to the person page.
image::{imgsdir}/new_menu_editperson.png[]

(((isFormStored, reloadPage)))
[[lst-mycontacts.client.forms.person.picturefield.editmenu, Listing EditPersonMenu]]
[source,java]
.The [java]+EditPersonMenu+ to edit the person selected in the person table. The person id taken from the corresponding (invisible) column is transferred to the person form before the form is started.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.client/src/org/eclipsescout/contacts/client/ui/desktop/outline/pages/PersonTablePage.java[lines=123..142]
----


The user of the "`My Contacts`" application wants to use the person form to show/edit attributes of a specific person.
To support this use case, we need to link this form with the "`My Contacts`" application.
As we already have person pages that show some of the person's attribute, we can now add context menus to this list to open/edit existing persons in the person form and to create new persons as well.
This is achieved by using the [wizard]_New Menu_ wizard on the [node]_Menus_ node of the table of the person page according to <<img-new_menu_editperson>>.
In the [field]_Name_ field enter the new translated text "`Edit Person ...`".
The form to start is the [java]+PersonForm+ and the [java]+ModifyHandler+ is the form handler to be used to start the form.
As we have defined a meaningful primary key column on the person page and a matching variable is available for the person form, the Scout SDK wizard is generating the necessary code automatically.
The implementation of the [java]+execAction+ method provided in <<lst-mycontacts.desktop.outline.personpage.editmenu>> works out of the box and should not need any manual tuning.
Now, you may also add the "`New Person ...`" menu in the same way.
Except that you pick the [java]+NewHander+ in the [wizard]_New Menu_ wizard instead of the modify handler.

[[img-person_table_properties, Figure 000]]
image::{imgsdir}/person_table_explorer.png[]
.Set the behaviour for the row level action on the person table.
image::{imgsdir}/person_table_properties.png[]

(((execRowAction)))
[[lst-mycontacts.desktop.outline.personpage.execrowaction, Listing execRowAction]]
[source,java]
.The [java]+execRowAction+ method on table pages is used to trigger an action when a row is selected with a double click or `<Enter>`.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.client/src/org/eclipsescout/contacts/client/ui/desktop/outline/pages/PersonTablePage.java[lines=63..67]
----


To open the person form with a double click on a person row or by hitting the kbd:[Enter] key, you may add a corresponding [java]+execRowAction+ on the person page.
This method can be added to the person table by clicking on the green plus icon next to the operation [element]_Exec Row Action_ as shown in <<img-person_table_properties>>.
For the implementation of this method you may reuse the functionality implemented for the context menu according to <<lst-mycontacts.desktop.outline.personpage.execrowaction>>.


[[sec-adding_the_smartfield]]
==== Adding the Company Smartfield

At the current stage of the "`My Contacts`" application, we have no option to manage the relationship between people and companies.
To manage this relation, we now add a company smart field to the person form.
This smart field will then hold the current assignment of the person represented in the person form.

A Scout smart field can be viewed as user friendly dropdown field on steroids that also implements [element]_search-as-you-type_ to pick a specific entry.
In the simplest case the smart field provides access to a small and locally provided list of key value pairs.
But for the intended use in the "`My Contacts`" application, we will need to access a list of elements provided by the server that will be compiled dynamically at runtime.

[[img-new_lookupcall_company_contextmenu, Figure 000]]
.Add a lookup call to the applications shared node.
image::{imgsdir}/new_lookupcall_company_contextmenu.png[]

[[img-new_lookupcall_company, Figure 000]]
image::{imgsdir}/new_lookupcall_company_1.png[]
.The two wizard steps to enter the details of the company lookup call.
image::{imgsdir}/new_lookupcall_company_2.png[]

To create the access to this list, we start with the creation of the company lookup call.
As shown in <<img-new_lookupcall_company_contextmenu>> the lookup call is added on the [folder]_Lookup Calls_ folder under the green shared node of the "`My Contacts`" application.
This opens the [wizard]_New Lookup Call_ wizard as shown in <<img-new_lookupcall_company>>.
In the first wizard step, enter "`Company`" into the [field]_Class Name_ field, "`services.lookup`" into the [field]_Sub Package_ field and "`String`" into the [field]_Key Type_ field.
Now verify that the wizard step looks the same as the screenshot shown on the left hand side of <<img-new_lookupcall_company>>.
Before the wizard is closed, click on the btn:[Next] button to move to the second wizard step.
As shown on the right hand side of <<img-new_lookupcall_company>>, the wizard will also create a corresponding [java]+CompanyLookupService+ on the application's server.
We can now close this wizard with the btn:[Finish] button and add the business logic to this company lookup service.

(((LookupCall, getConfiguredService, CompanyLookupCall)))
[[lst-mycontacts.shared.lookup.companylookupcall, Listing CompanyLookupCall]]
[source,java]
.The company lookup call with its [java]+getConfiguredService+ method in the application's shared plugin.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.shared/src/org/eclipsescout/contacts/shared/services/lookup/CompanyLookupCall.java[lines=12..21]
----


(((AbstractSqlLookupService, getConfiguredSqlSelect)))
[[lst-mycontacts.server.lookup.companylookupservice, Listing CompanyLookupService]]
[source,java]
.The company lookup service in the application's server plugin. The [java]+key+ and the [java]+text+ criteria are used to search for values by key or by the provided name substring.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.server/src/org/eclipsescout/contacts/server/services/lookup/CompanyLookupService.java[lines=6..20]
----


The [java]+CompanyLookupCall+ just created by the Scout SDK wizard is provided in <<lst-mycontacts.shared.lookup.companylookupcall>>.
As we can see, the only method implemented is [java]+getConfiguredService+ that points to the specific server service to be used.
In the Scout Explorer, the new company lookup service can be found in the [folder]_Lookup Services_ folder under the blue server node of the application.
In this service, we need to implement method [java]+getConfiguredSqlSelect+ as shown in <<lst-mycontacts.server.lookup.companylookupservice>>.
For Scout lookup services, specific [element]_key_, [element]_text_ and [element]_all_ criteria blocks need to be provided.
This criteria are included in the [java]+SELECT+ statement using the [java]+<key>+, [java]+<text>+ and [java]+<all>+ tags as shown in the listing.
The Scout runtime uses the [java]+<key>+-block in cases where a specific key is already assigned to the smart field.
The [java]+<text>+-block is used as a query criteria to create the dynamic [element]_search-as-you-type_ hit list based on the (sub)string entered by the user so far.
Finally, the [java]+<all>+-block is used to define the hit list to be shown when the user does not enter any text into the smart field but clicks on the field's search icon instead.
The bind variable [java]+:key+ and [java]+:text+ are provided by Scout and hold the value of the assigned key or the text entered into the smart field.

[[img-new_smartfield_company_contextmenu, Figure 000]]
.Add a smart field to the person form.
image::{imgsdir}/new_smartfield_company_contextmenu.png[]

[[img-new_smartfield_company, Figure 000]]
image::{imgsdir}/new_smartfield_company_1.png[]
.Create the company smart field for the person form. In the second wizard step shown on the right side, first remove the content in the [field]_Generic Type_ field and then select the company lookup call into the corresponding field.
image::{imgsdir}/new_smartfield_company_2.png[]

We are now ready to add the company smart field to the person form.
To start the [wizard]_New Form Field_ wizard we use the context menu on the [java]+DetailBox+ of the person form as shown in <<img-new_smartfield_company>>.
In the first wizard step, we chose the [element]_SmartField_ entry as the field type and click the btn:[Next] button.
Then, we enter "`Company`" into the [field]_Name_ field as shown on the right hand side of <<img-new_smartfield_company>>.
Make sure that you select the [element]_String_ entry in the [field]_Generic Type_ field as we are using string values to identify companies in the "`My Contacts`" application.
And in the [field]_LookupCall_ field, we can now select the [element]_CompanyLookupCall_ that we have just created before.
Finally, the position of the new company smart field can be set in the [field]_Sibling_ field before the location field before the wizard is closed with the btn:[Finish] button.

(((AbstractSmartField, getConfiguredLookupCall)))
[[lst-mycontacts.client.forms.person.companyfield, Listing CompanyField]]
[source,java]
.The smart field [java]+CompanyField+ of the person form and its wiring with the company lookup call.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.client/src/org/eclipsescout/contacts/client/ui/forms/PersonForm.java[lines=324..337]
----


The implementation of the company smart field created by the Scout SDK wizard is provided in <<lst-mycontacts.client.forms.person.companyfield>>.
A look at the implementation of the [java]+CompanyField+ class shows the wiring with the company lookup service.


==== Adding the Map Form

We now want to add the "`Map`" form shown in the front of <<img-my_contacts_swt>>.
The purpose of this form is to show a map corresponding to the address entered into the [field]_location_ field of the person form using the Google Maps Image API.footnote:[
The Google Maps Image API can be used to fetch static map images: https://developers.google.com/maps/documentation/imageapis/.
].
This implies that map images will only be shown in the map form if the entered address can be parsed by the Google Maps Image API.

To create the maps form we start the [wizard]_New Form_ wizard and enter the new translated text "`Map`" into the [field]_Name_ field and "`ui.forms`" into the [field]_Sub Package_ field of the first wizard step.
Then, we click the btn:[Next] button to configure the artefacts to be created by the wizard.
For the map form we can use the configuration as shown on the right hand side of <<img-new_form_url>> with the difference that we do not need the cancel button.
Having deselected all artefacts except for the ok button and the modify handler, the wizard can be closed with the btn:[Finish] button.

After the form creation wizard has been closed, we can add an "`Address`" variable to the form by starting the [wizard]_New Property Bean_ wizard on the [node]_Variables_ node of the newly created map form.
In the property bean wizard, enter "`Address`" into the [field]_Name_ field and set the [field]_Bean type_ field to [element]_String_.

As the next step, the map image field is added to the from.
For this, start the [wizard]_New Form Field_ wizard directly on the form's [node]_MainBox_ node.
In the first form field wizard step, select [element]_ImageField_ as the field type and click on the btn:[Next] button.
Now enter "`Map`" into the [field]_Class Name_ field and close the second wizard step with the btn:[Finish] button.
To set the properties of the new map field, select the [node]_MapField_ node below the main box node of the map form.
In the [java]+MapField+'s Scout Object Properties untick the [property]_Label Visible_ property and add an [java]+execInitField+ method by clicking on the green plus icon next to this operation.
The configuration of the map field can then be completed in section [element]_Advanced Properties_.
Here, we set the [property]_Grid H_ property to 6 and update the [property]_Width in Pixel_ property and the [property]_Height in Pixel_ property to a value of 400 each.

(((execInitField, AbstractImageField)))
[[lst-mycontacts.client.forms.map, Listing execInitField]]
[source,java]
.In the [java]+execInitField+ method of the map form the image content is fetched from the Google Maps API.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.client/src/org/eclipsescout/contacts/client/ui/forms/MapForm.java[lines=115..133]
----


To add the Java code to display the map in the image field, click on the [link]_execInitField_ link in the Scout Object Properties of the map field.
According to the implementation provided in <<lst-mycontacts.client.forms.map>>, an URL for the Maps Image API is first constructed.
This url also contains the content of the map form's address variable and the configured dimension of the map field.
The map picture returned by the Google API is then read using [java]+IOUtility.getContent+ and directly fed into the image fields `setImage` method.

The last step involving the implementation of the map form feature is its integration into the person form.
As visible on the lower left part of the person form shown in <<img-my_contacts_swt>>, a [link]_Show Map ..._ link is available.
We now add such a link to the person form including the necessary wiring for opening the newly created map form.
For this, navigate to the person form in the Scout SDK and click on its [node]_MainBox_ node below.
Then, open the context menu on the [node]_MainBox_ node and start the [wizard]_New Form Field_ wizard.
In the first wizard step, select the [element]_LinkButton_ from the available field types and click the btn:[Next] button to load the second wizard step.
Here, just enter the new translated text "`Show Map ...`" into the [field]_Name_ field and close the wizard with the btn:[Finish] button.

(((execClickAction)))
[[lst-mycontacts.client.forms.person.clickmaplink, Listing ShowMapButton]]
[source,java]
.The implementation of the "`Show Map ...`" link button. %In method `execClickAction` a new map form is first created, the the address variable is set with the content of the person's location and the form is opened with `startModify`.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.client/src/org/eclipsescout/contacts/client/ui/forms/PersonForm.java[lines=347..362]
----


To add the necessary wiring code to the link button double click the [node]_ShowMapButton_ node in the Scout Explorer and implement its [java]+execClickAction+ method.
As shown in <<lst-mycontacts.client.forms.person.clickmaplink>>, we only need to create a new map form in the click action, set its address variable and open the form with [java]+form.startModify+.


=== Managing Person Data on the Server Side

(((ModifyHandler,AbstractFormHandler)))
[[lst-mycontacts.client.personform.modifyhandler, Listing ModifyHandler]]
[source,java]
.The [java]+execLoad+ and the  [java]+execStore+ methods of the person form's modify handler.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.client/src/org/eclipsescout/contacts/client/ui/forms/PersonForm.java[lines=364..384]
----


In the "`My Contacts`" client application the person form is opened via the context menues "`Edit Person ...`" and "`New Person ...`" on the person page.
And for each context menu, the person form is started with the corresponding form handler.
The new handler is used to start the form in the mode to create new persons while the modify handler is implemented to start the form for updating existing persons.
When we look at the implementation of the modify handler provided in <<lst-mycontacts.client.personform.modifyhandler>>, we see that it only contains the two methods [java]+execLoad+ and [java]+execStore+.
As described in Section <<sec-helloworld.formhandler>> of the "`Hello World`" tutorial, [java]+execLoad+ is called by the Scout framework when the form is started.
And method [java]+execStore+ is called by the Scout framework after the user has clicked the btn:[OK] button of a form.

(((PersonService)))
[[lst-mycontacts.server.services.personservice.load, Listing PersonService load and store]]
[source,java]
.The [java]+load+ and the [java]+store+ methods of the server's [java]+PersonService+.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.server/src/org/eclipsescout/contacts/server/ui/forms/PersonService.java[lines=24..25;55..104]
----


In both the [java]+execLoad+ and the [java]+execStore+ methods, the person service is used.
In [java]+execLoad+ by calling [java]+service.load+ to fetch the person's data from the Scout server, and in [java]+execStore+ by calling [java]+service.store+ to transfer the updated data to the Scout server.
The implementation of the Scout server's [java]+load+ and [java]+store+ methods for the [java]+PersonService+ is provided in <<lst-mycontacts.server.services.personservice.load>>.
To load the correct person data, the [java]+load+ method expects the person's id as an input parameter [java]+personId+ in the [java]+formData+.

For the data binding between the [java]+formData+ and the attributes in the database tables Scout provides support in the methods of the [java]+SQL+ class.
This support is first searching for the pattern "`:<variable>`" in the provided SQL statement.
For all such patterns found, the binding to the corresponding [java]+getVariable+ and [java]+setVariable+ methods of the form data object is performed by the Scout framework at runtime.

The implementation of the person form's new handler is implemented similar to it's modify handler.
Instead of calling the service operations [java]+load+ and [java]+store+, the methods  [java]+prepareCreate+ and [java]+create+ are used.
In principle, method [java]+prepareCreate+ is not needed for the "`My Contacts`" application.
As its implementation has been created by the Scout SDK wizard, it does not do any harm and the method can be left unchanged.

(((PersonService)))
[[lst-mycontacts.server.services.personservice.create, Listing PersonService create]]
[source,java]
.The [java]+create+ method of the server's [java]+PersonService+.
----
TODO include was {codedir}/oneDayTutorial/org.eclipsescout.contacts.server/src/org/eclipsescout/contacts/server/ui/forms/PersonService.java[lines=24..25;35..54;103..104]
----


In <<lst-mycontacts.server.services.personservice.create>> the implementation of the [java]+PersonService+'s [java]+create+ method is provided.
First, the implementation checks if the provided form data contains a person id.
If the person has been entered manually, a person id is initially missing and a new one needs to be created and assigned.
For this, method [java]+randomUUID()+ of the Java class [java]+java.util.UUID+ is used.
The only responsibility of the [java]+INSERT+ statement following the person id check is to make sure we will have a row in the [java]+PERSON+ table for the person to be created.
To save all the other form data parameters, we can reuse the previously implemented [java]+store+ method.



=== Creating the Company Form

Creating the company form and the necessary backend services is not described here.
Instead, this task is left as an exercise to the reader and in the text below some minimal guidelines are provided.

To create the company form, start with the [wizard]_New Form_ wizard as in the case of the person form.
This will then create all necessary artefacts including the forms, the server service, and the form data for the communication between the client and the server.
And don't forget to add a [java]+companyId+ variable to the company form.
To decide on the fields that need to be on the company form you may check the setup of the database schema provided in <<lst-mycontacts.server.services.installdb.company>>.
If in doubt about what to do, please refer to the procedure used to create the person form.

In case you get lost completely, you may download the "`My Contacts`" application from this books Github repository as described in the Scout wiki.footnote:[
Download and installation of the "`My Contacts`" application: http://wiki.eclipse.org/Scout/Book/4.0#Download_and_Run_the_Scout_Sample_Applications.
].
